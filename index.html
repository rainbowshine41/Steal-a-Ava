<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Steal-a-Ava — Roblox-style Prototype</title>
  <style>
    :root{
      --hot-pink: #ff2d8f;
      --bright-blue: #00b0ff;
      --bg-grad: linear-gradient(180deg,var(--hot-pink),#ff80bf);
      --card-bg: rgba(255,255,255,0.06);
      --glass: rgba(255,255,255,0.06);
      --muted: #ffffff88;
      font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, Arial;
    }
    *{box-sizing:border-box}
    body{min-height:100vh;margin:0;background:var(--bg-grad);color:white}

    /* top bar */
    .topbar{display:flex;align-items:center;justify-content:space-between;padding:12px 20px;gap:12px}
    .left-top{display:flex;align-items:center;gap:12px}
    .profile{display:flex;align-items:center;gap:10px}
    .avatar-blob{width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,#ffd6a6,#ffd2f0);display:flex;align-items:center;justify-content:center;color:#2b2b2b;font-weight:800}
    h1{margin:0;color:var(--bright-blue);font-size:20px}
    .search{flex:1;max-width:560px;margin:0 18px}
    .search input{width:100%;padding:10px 14px;border-radius:12px;border:0;outline:none;font-size:16px}

    .right-top{display:flex;align-items:center;gap:12px}
    .btn{background:var(--bright-blue);color:#001;padding:8px 12px;border-radius:10px;font-weight:700;border:0}

    /* main layout */
    .container{display:flex;gap:18px;padding:18px}
    .sidebar{width:320px;min-width:260px}
    .main{flex:1}

    .card{background:var(--card-bg);padding:12px;border-radius:14px;box-shadow:0 10px 30px rgba(0,0,0,0.25)}

    /* servers list */
    .servers{display:flex;flex-direction:column;gap:8px}
    .server{display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:10px;background:rgba(255,255,255,0.03);cursor:pointer}
    .server:hover{background:rgba(255,255,255,0.05)}

    /* game board */
    .game-board{display:flex;flex-direction:column;gap:12px;margin-top:12px}
    .arena{display:grid;grid-template-columns:1fr 120px 1fr;gap:12px;align-items:center}

    .base-column{display:flex;flex-direction:column;gap:8px;align-items:center}
    .base{width:240px;background:rgba(0,0,0,0.18);padding:8px;border-radius:10px}
    .base h4{margin:0 0 6px 0}
    .slots{display:grid;grid-template-columns:repeat(4,1fr);gap:6px}
    .slot{height:64px;background:rgba(255,255,255,0.04);border-radius:6px;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:6px;font-size:12px}
    .slot.empty{opacity:0.45}
    .slot .name{font-weight:700}
    .slot .rarity{font-size:11px;opacity:0.85}

    .track{width:100%;height:360px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);border-radius:12px;display:flex;align-items:center;justify-content:center;position:relative}
    .track .lane{position:absolute;left:50%;transform:translateX(-50%);width:8px;height:100%;background:linear-gradient(#ffffff22,#ffffff11);border-radius:4px}

    .ava-piece{position:absolute;width:78px;height:78px;border-radius:10px;background:#ffd7b3;display:flex;flex-direction:column;align-items:center;justify-content:center;font-weight:800}
    .ava-piece .small{font-size:10px;font-weight:600}

    .controls{display:flex;gap:8px;margin-top:8px}

    /* scoreboard */
    .scoreboard{display:flex;gap:12px;align-items:center}
    .money{font-weight:900;font-size:18px}

    /* responsive */
    @media (max-width:900px){
      .container{flex-direction:column}
      .sidebar{width:100%}
    }
  </style>
</head>
<body>
  <div class="topbar">
    <div class="left-top">
      <div class="profile">
        <div class="avatar-blob">A</div>
        <div>
          <h1>Steal-a-Ava</h1>
          <div style="font-size:12px;color:#fff8">Roblox — Steal-A-Brainrot inspired</div>
        </div>
      </div>
    </div>

    <div class="search">
      <input id="searchInput" placeholder="Search games, servers, Avas..." />
    </div>

    <div class="right-top">
      <button class="btn">Add Friends</button>
      <div style="font-size:13px;color:#fff8;text-align:right">
        <div id="playerName">You</div>
        <div style="font-size:11px;color:#fff5">Level 1</div>
      </div>
    </div>
  </div>

  <div class="container">
    <aside class="sidebar">
      <div class="card">
        <h3 style="margin:0 0 8px 0">Games — "Steal A Ava" (multiple servers)</h3>
        <div class="servers" id="serversList"></div>
      </div>

      <div style="height:12px"></div>

      <div class="card">
        <h4 style="margin:0 0 8px 0">Profile</h4>
        <div class="scoreboard">
          <div class="money">$<span id="money">0</span></div>
          <div style="opacity:0.8">Balance</div>
        </div>
        <div style="height:8px"></div>
        <div><button id="createServer" class="btn">Create Server</button></div>
      </div>
    </aside>

    <main class="main">
      <div id="gameArea" class="card">
        <h3 id="gameTitle">Select a server to join</h3>
        <div id="gameView" class="game-board" style="display:none">
          <div class="arena">
            <div class="base-column" id="leftBases"></div>
            <div class="track" id="trackArea">
              <div class="lane"></div>
            </div>
            <div class="base-column" id="rightBases"></div>
          </div>

          <div class="controls">
            <button id="lockBase" class="btn">Lock My Base (60s)</button>
            <button id="stealBtn" class="btn">Steal From Other Base</button>
            <button id="spawnAva" class="btn">Spawn Random Ava</button>
            <div style="flex:1"></div>
            <div style="font-size:13px;opacity:0.9">You are: <strong id="currentPlayer">You</strong></div>
          </div>
        </div>
      </div>

      <div style="height:12px"></div>

      <div class="card" style="margin-top:12px">
        <h4 style="margin:0">Server log</h4>
        <div id="log" style="max-height:160px;overflow:auto;padding:8px;font-size:13px;color:#fff8"></div>
      </div>
    </main>
  </div>

  <script>
    /* --- Data models --- */
    const rarities = [
      {id:'common',label:'Common',min:1,max:1},
      {id:'rare',label:'Rare',min:250,max:400},
      {id:'epic',label:'Epic',min:500,max:1000},
      {id:'legendary',label:'Legendary',min:1500,max:5500},
      {id:'mythic',label:'Mythic',min:6000,max:20000},
      {id:'avagod',label:'Ava God',min:25000,max:50000},
      {id:'secret',label:'Secret',min:550000,max:1500000}
    ];

    // generate creative ava names
    function generateAvaName(i){
      const silly = ['Bubucaca','Spronk','Gigglepuff','Zelava','Crunchy','Fizzle','TacoAva','Bubblegum','Sparkle','Noodle','Zebra','Flipflop','DingDong','Poptart','Muffin'];
      return `Ava ${silly[i% silly.length]}${i>0?i:''}`;
    }

    function randomFrom(arr){return arr[Math.floor(Math.random()*arr.length)];}

    function randomRarity(){
      // weighted distribution: common common common, few rares...
      const pool = [].concat(
        Array(45).fill('common'),
        Array(25).fill('rare'),
        Array(15).fill('epic'),
        Array(8).fill('legendary'),
        Array(5).fill('mythic'),
        Array(1).fill('avagod'),
        Array(1).fill('secret')
      );
      return randomFrom(pool);
    }

    // server structure
    let servers = [];
    let serverIdCounter = 1;

    function createServer(name){
      const s = {
        id: serverIdCounter++,
        name: name||`Steal-a-Ava #${serverIdCounter}`,
        bases: [],
        // 4 bases (2 left, 2 right)
        players: {},
        aInstances: [],
        log: []
      };
      // create 4 bases, each with 8 slots
      for(let b=0;b<4;b++){
        s.bases.push({id:b,owner:`Player${b+1}`,slots:Array(8).fill(null),locked:false,lockExpires:0});
      }
      servers.push(s);
      return s;
    }

    // initial servers
    for(let i=0;i<3;i++) createServer(`Steal-a-Ava Server ${i+1}`);

    // UI bindings
    const serversList = document.getElementById('serversList');
    const gameTitle = document.getElementById('gameTitle');
    const gameView = document.getElementById('gameView');
    const leftBasesEl = document.getElementById('leftBases');
    const rightBasesEl = document.getElementById('rightBases');
    const trackArea = document.getElementById('trackArea');
    const logEl = document.getElementById('log');
    const moneyEl = document.getElementById('money');

    let currentServer = null;
    let playerProfile = {name:'You',baseIndex:0,money:0};
    document.getElementById('currentPlayer').textContent = playerProfile.name;

    function renderServers(){
      serversList.innerHTML='';
      servers.forEach(s=>{
        const div = document.createElement('div');
        div.className='server';
        div.innerHTML = `<div><strong>${s.name}</strong><div style="font-size:12px;opacity:0.9">${s.aInstances.length} Avas active</div></div><div><button class='btn small'>Join</button></div>`;
        div.querySelector('button').addEventListener('click',()=>joinServer(s.id));
        serversList.appendChild(div);
      });
    }

    function log(s,txt){
      const t = `[${new Date().toLocaleTimeString()}] ${txt}`;
      s.log.unshift(t);
      if(s.log.length>200) s.log.pop();
      if(currentServer && currentServer.id===s.id){
        renderLog();
      }
    }

    function renderLog(){
      logEl.innerHTML = currentServer.log.map(l=>`<div>${l}</div>`).join('');
    }

    function joinServer(id){
      currentServer = servers.find(x=>x.id===id);
      gameTitle.textContent = `${currentServer.name} — Joined`;
      gameView.style.display='block';
      renderServerView();
      renderLog();
      log(currentServer, `${playerProfile.name} joined the server.`);
    }

    function renderServerView(){
      leftBasesEl.innerHTML=''; rightBasesEl.innerHTML='';
      // left two are index 0 & 1, right two are 2 & 3
      for(let i=0;i<2;i++){
        leftBasesEl.appendChild(renderBase(currentServer.bases[i]));
      }
      for(let i=2;i<4;i++){
        rightBasesEl.appendChild(renderBase(currentServer.bases[i]));
      }
      // clear track pieces
      // track pieces are absolute children of trackArea
      Array.from(trackArea.querySelectorAll('.ava-piece')).forEach(n=>n.remove());
      // render floating aInstances
      currentServer.aInstances.forEach(inst=>renderAvaPiece(inst));
      updateMoneyDisplay();
    }

    function renderBase(base){
      const container = document.createElement('div');
      container.className='base-column';
      const box = document.createElement('div');box.className='base card';
      const h = document.createElement('h4');h.textContent = `${base.owner} (Base ${base.id+1})`;
      const lockText = document.createElement('div');lockText.style.fontSize='12px';lockText.style.opacity='0.9';lockText.style.marginTop='6px';
      function updateLockText(){
        if(base.locked){
          const sec = Math.max(0,Math.ceil((base.lockExpires - Date.now())/1000));
          lockText.textContent = `Locked — ${sec}s`;
        } else lockText.textContent = 'Unlocked';
      }
      updateLockText();
      const slots = document.createElement('div');slots.className='slots';
      base.slots.forEach((s,i)=>{
        const slot = document.createElement('div');slot.className='slot '+(s?'':'empty');
        if(s){
          slot.innerHTML = `<div class='name'>${s.name}</div><div class='rarity'>${s.rarity}</div><div style="font-size:11px;margin-top:6px">$<span>${formatNumber(Math.floor(s.accrued||0))}</span></div>`;
          // claim money button
          const claim = document.createElement('button');claim.textContent='Claim $';claim.style.fontSize='11px';claim.style.marginTop='6px';claim.addEventListener('click',()=>{
            const amt = Math.floor(s.accrued||0);
            playerProfile.money += amt;
            s.accrued = 0;
            updateMoneyDisplay();
            renderServerView();
            log(currentServer, `${playerProfile.name} claimed $${formatNumber(amt)} from ${s.name}.`);
          });
          slot.appendChild(claim);
          // steal button if not your base
          if(base.owner !== playerProfile.name){
            const stealB = document.createElement('button');stealB.textContent='Steal Ava';stealB.style.fontSize='11px';stealB.style.marginTop='6px';stealB.addEventListener('click',()=>attemptStealFromSlot(base,i));
            slot.appendChild(stealB);
          }
        } else {
          slot.textContent = 'Empty';
        }
        slots.appendChild(slot);
      });

      // base controls
      const controls = document.createElement('div');controls.style.marginTop='8px';controls.style.display='flex';controls.style.gap='6px';
      const claimAll = document.createElement('button');claimAll.className='btn';claimAll.style.padding='6px 8px';claimAll.textContent='Claim All';claimAll.addEventListener('click',()=>{
        let total=0;
        base.slots.forEach(s=>{if(s){total+=Math.floor(s.accrued||0);s.accrued=0;}});
        playerProfile.money+=total;updateMoneyDisplay();renderServerView();log(currentServer,`${playerProfile.name} claimed $${formatNumber(total)} from ${base.owner}'s base.`);
      });
      const lockBtn = document.createElement('button');lockBtn.className='btn';lockBtn.style.padding='6px 8px';lockBtn.textContent='Lock (60s)';lockBtn.addEventListener('click',()=>{
        if(base.owner!==playerProfile.name){ alert('You can only lock your own base (for this prototype your base is Base 1).'); return; }
        if(base.locked){ alert('Base already locked'); return; }
        base.locked=true; base.lockExpires=Date.now()+60000; updateLockText(); log(currentServer,`${playerProfile.name} locked their base for 60s.`);
      });

      controls.appendChild(claimAll);
      controls.appendChild(lockBtn);

      box.appendChild(h);box.appendChild(lockText);box.appendChild(slots);box.appendChild(controls);
      container.appendChild(box);
      // update lock countdown every second
      setInterval(()=>{
        if(base.locked && Date.now()>base.lockExpires){ base.locked=false; updateLockText(); renderServerView(); log(currentServer,`${base.owner}'s base unlocked.`); }
        else updateLockText();
      },1000);
      return container;
    }

    function formatNumber(n){
      return n.toLocaleString();
    }

    // create an Ava instance that moves down the track
    let avaCounter = 0;
    function spawnRandomAva(){
      const name = generateAvaName(avaCounter++);
      const rarityKey = randomRarity();
      const rarity = rarities.find(r=>r.id===rarityKey)||rarities[0];
      const valuePerSec = Math.floor(Math.random()*(rarity.max - rarity.min +1)+rarity.min);
      const inst = {id: 'ava-'+Date.now()+'-'+Math.random().toString(36).slice(2,7), name,rarity:rarity.label,rarityKey,valuePerSec,position:0,claimedBy:null,accrued:0,ownerSide: Math.random()>0.5? 'left':'right'};
      currentServer.aInstances.push(inst);
      renderAvaPiece(inst);
      log(currentServer, `Spawned ${inst.name} (${inst.rarity}) worth $${formatNumber(inst.valuePerSec)}/s on ${inst.ownerSide} side.`);
    }

    function renderAvaPiece(inst){
      // create element if not exists
      let el = document.getElementById(inst.id);
      if(!el){
        el = document.createElement('div');el.className='ava-piece';el.id=inst.id;el.innerHTML = `<div style="font-size:13px">${inst.name}</div><div class='small'>${inst.rarity}</div>`;
        trackArea.appendChild(el);
        // click to claim (pick up)
        el.addEventListener('click',()=>claimAva(inst));
      }
      // position along lane: position 0 to 100
      const trackRect = trackArea.getBoundingClientRect();
      const laneX = trackRect.width/2 - 39; // center
      // compute y based on ownerSide and position
      const sideOffset = inst.ownerSide==='left' ? -150 : 150;
      const y = 40 + inst.position*(trackRect.height-120)/100;
      const x = trackRect.width/2 + sideOffset*Math.cos(inst.position*Math.PI/200) - 39;
      el.style.transform = `translate(${x}px, ${y}px)`;
    }

    // move instances each tick
    setInterval(()=>{
      if(!currentServer) return;
      currentServer.aInstances.forEach(inst=>{
        // if not claimed, move forward
        if(!inst.claimedBy){
          inst.position = Math.min(100, inst.position + (Math.random()*1.8 + 0.6));
          // if reached end opposite side, despawn
          if(inst.position>=100){
            // despawn if not claimed
            currentServer.aInstances = currentServer.aInstances.filter(i=>i.id!==inst.id);
            const el = document.getElementById(inst.id); if(el) el.remove();
            log(currentServer, `${inst.name} despawned (not claimed).`);
            return;
          }
        } else {
          // if claimed, accrue money to slot or to carried holder
          inst.accrued += inst.valuePerSec/10; // tick is 100ms? but interval here is 1000ms? We'll update per second below
        }
        // update accrual in owned slots
        updateAccruals(inst);
        renderAvaPiece(inst);
      });
      // second-based accrual for each slot
    },200);

    // per-second accrual applying to any avas in base slots
    setInterval(()=>{
      if(!currentServer) return;
      currentServer.bases.forEach(base=>{
        base.slots.forEach(s=>{if(s){ s.accrued = (s.accrued||0) + s.valuePerSec; }});
      });
      // also for carried avas (claimedBy)
      currentServer.aInstances.forEach(inst=>{
        if(inst.claimedBy && inst.carriedToBaseIndex!=null){
          // not added until placed
        }
      });
      renderServerView();
    },1000);

    function updateAccruals(inst){
      // if inst is assigned to a slot (placed), its accrued is tracked on slot; otherwise inst.accrued increments when claimed
      if(inst.placed){
        // find slot and transfer
        const base = currentServer.bases[inst.placed.baseIndex];
        const slot = base.slots[inst.placed.slotIndex];
        if(slot){
          slot.accrued = (slot.accrued||0) + inst.valuePerSec;
        }
      }
    }

    function claimAva(inst){
      // clicking on an ava picks it up if not claimed
      if(inst.claimedBy){ alert('Already claimed'); return; }
      inst.claimedBy = playerProfile.name;
      inst.carried = true;
      log(currentServer, `${playerProfile.name} clicked to claim ${inst.name}. Carry it back to your base.`);
      // animate movement toward player's base and place in first empty slot when arrived
      const targetBaseIndex = playerProfile.baseIndex; // base 0
      inst.carriedToBaseIndex = targetBaseIndex;
      // move it visually to the base slot over time
      const el = document.getElementById(inst.id);
      if(!el) return;
      // simulate travel then attempt place
      setTimeout(()=>{
        // find first empty slot in your base
        const base = currentServer.bases[targetBaseIndex];
        const emptyIndex = base.slots.findIndex(s=>!s);
        if(emptyIndex===-1){
          // can't place, drop it and it disappears
          inst.claimedBy = null; inst.carried=false; log(currentServer, `${playerProfile.name} couldn't place ${inst.name} — base full. It dropped and despawned.`);
          currentServer.aInstances = currentServer.aInstances.filter(i=>i.id!==inst.id);
          if(el) el.remove();
          renderServerView();
          return;
        }
        // place into base slot
        base.slots[emptyIndex] = {name:inst.name,rarity:inst.rarity,rarityKey:inst.rarityKey,valuePerSec:inst.valuePerSec,accrued:0};
        currentServer.aInstances = currentServer.aInstances.filter(i=>i.id!==inst.id);
        if(el) el.remove();
        log(currentServer, `${playerProfile.name} placed ${inst.name} into ${base.owner}'s base slot ${emptyIndex+1}.`);
        renderServerView();
      },1200 + Math.random()*1200);
    }

    function attemptStealFromSlot(base,slotIndex){
      // check lock
      if(base.locked){ alert('Base is locked — cannot steal now.'); return; }
      const slot = base.slots[slotIndex];
      if(!slot){ alert('No Ava in that slot'); return; }
      // pick up the ava (simulate steal)
      const avaName = slot.name;
      // remove from base
      base.slots[slotIndex]=null;
      // create a carried instance owned by thief
      const inst = {id:'ava-stolen-'+Date.now(),name:avaName,rarity:slot.rarity,rarityKey:slot.rarityKey,valuePerSec:slot.valuePerSec,position:0,claimedBy:playerProfile.name,accrued:0,ownerSide:'left'};
      currentServer.aInstances.push(inst);
      renderAvaPiece(inst);
      log(currentServer, `${playerProfile.name} stole ${avaName} from ${base.owner}! Carry it back to your base.`);
      // auto-place after delay
      setTimeout(()=>{
        const myBase = currentServer.bases[playerProfile.baseIndex];
        const emptyIndex = myBase.slots.findIndex(s=>!s);
        if(emptyIndex===-1){
          // drop
          currentServer.aInstances = currentServer.aInstances.filter(i=>i.id!==inst.id);
          log(currentServer, `${playerProfile.name} dropped ${avaName} — no space in base.`);
          renderServerView();
          return;
        }
        myBase.slots[emptyIndex] = {name:inst.name,rarity:inst.rarity,rarityKey:inst.rarityKey,valuePerSec:inst.valuePerSec,accrued:0};
        currentServer.aInstances = currentServer.aInstances.filter(i=>i.id!==inst.id);
        log(currentServer, `${playerProfile.name} placed stolen ${avaName} into their base.`);
        renderServerView();
      },1200 + Math.random()*1600);
    }

    function updateMoneyDisplay(){
      moneyEl.textContent = formatNumber(playerProfile.money);
    }

    // UI actions
    document.getElementById('createServer').addEventListener('click',()=>{
      const s = createServer(`Steal-a-Ava Server ${servers.length+1}`);
      renderServers();
      log(s, 'Server created');
    });

    document.getElementById('spawnAva').addEventListener('click',()=>{
      if(!currentServer) return alert('Join a server first');
      spawnRandomAva();
      renderServerView();
    });

    document.getElementById('lockBase').addEventListener('click',()=>{
      if(!currentServer) return alert('Join a server first');
      const base = currentServer.bases[playerProfile.baseIndex];
      if(base.locked) return alert('Your base is already locked');
      base.locked=true; base.lockExpires=Date.now()+60000; log(currentServer, `${playerProfile.name} locked their base for 60s`); renderServerView();
    });

    document.getElementById('stealBtn').addEventListener('click',()=>{
      if(!currentServer) return alert('Join a server first');
      // pick a random other base with at least one ava and unlocked
      const targets = currentServer.bases.filter((b,idx)=>idx!==playerProfile.baseIndex && b.slots.some(s=>s)&&!b.locked);
      if(targets.length===0) return alert('No stealable bases available (they may be locked or empty).');
      const t = randomFrom(targets);
      // pick random occupied slot
      const occIdx = t.slots.findIndex(s=>s);
      if(occIdx===-1) return alert('No ava to steal');
      attemptStealFromSlot(t,occIdx);
    });

    // search filter
    document.getElementById('searchInput').addEventListener('input',(e)=>{
      const q = e.target.value.toLowerCase();
      Array.from(serversList.children).forEach(div=>{
        const txt = div.innerText.toLowerCase();
        div.style.display = txt.includes(q)?'flex':'none';
      });
    });

    // initial render
    renderServers();

    // seed some random spawns every 6-12s
    setInterval(()=>{
      if(currentServer && Math.random()<0.6) spawnRandomAva();
    },6000+Math.random()*6000);

    // expose for debugging
    window.__SERVERS__ = servers;
  </script>
</body>
</html>
